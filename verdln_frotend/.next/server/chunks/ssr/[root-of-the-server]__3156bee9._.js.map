{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jean%20Bosco/Desktop/FullStack/Verdln/verdln_frotend/Utils/api.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:5000/api\";\r\n\r\n// Helper to get token\r\nfunction getToken() {\r\n  if (typeof window !== \"undefined\") {\r\n    return localStorage.getItem(\"authToken\");\r\n  }\r\n  return null;\r\n}\r\n\r\n// GET request\r\nexport async function apiGet(endpoint) {\r\n  try {\r\n    const token = getToken();\r\n    const res = await axios.get(`${API_URL}${endpoint}`, {\r\n      headers: token ? { Authorization: `Bearer ${token}` } : {},\r\n    });\r\n    return res.data;\r\n  } catch (err) {\r\n    throw err.response?.data || err;\r\n  }\r\n}\r\n\r\n// POST request\r\nexport async function apiPost(endpoint, payload) {\r\n  try {\r\n    const token = getToken();\r\n    const res = await axios.post(`${API_URL}${endpoint}`, payload, {\r\n      headers: token ? { Authorization: `Bearer ${token}` } : {},\r\n    });\r\n    return res.data;\r\n  } catch (err) {\r\n    throw err.response?.data || err;\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,UAAU,QAAQ,GAAG,CAAC,mBAAmB,IAAI;AAEnD,sBAAsB;AACtB,SAAS;IACP;;IAGA,OAAO;AACT;AAGO,eAAe,OAAO,QAAQ;IACnC,IAAI;QACF,MAAM,QAAQ;QACd,MAAM,MAAM,MAAM,oMAAK,CAAC,GAAG,CAAC,GAAG,UAAU,UAAU,EAAE;YACnD,SAAS,QAAQ;gBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;YAAC,IAAI,CAAC;QAC3D;QACA,OAAO,IAAI,IAAI;IACjB,EAAE,OAAO,KAAK;QACZ,MAAM,IAAI,QAAQ,EAAE,QAAQ;IAC9B;AACF;AAGO,eAAe,QAAQ,QAAQ,EAAE,OAAO;IAC7C,IAAI;QACF,MAAM,QAAQ;QACd,MAAM,MAAM,MAAM,oMAAK,CAAC,IAAI,CAAC,GAAG,UAAU,UAAU,EAAE,SAAS;YAC7D,SAAS,QAAQ;gBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;YAAC,IAAI,CAAC;QAC3D;QACA,OAAO,IAAI,IAAI;IACjB,EAAE,OAAO,KAAK;QACZ,MAAM,IAAI,QAAQ,EAAE,QAAQ;IAC9B;AACF","debugId":null}},
    {"offset": {"line": 145, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jean%20Bosco/Desktop/FullStack/Verdln/verdln_frotend/app/farmer/dashboard/page.jsx"],"sourcesContent":["\"use client\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useLanguage } from \"@/Context/LanguageContext\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { apiGet, apiPost } from \"@/Utils/api\";\r\nimport { useAuth } from \"@/Context/AuthContext\"; // <- import AuthContext\r\n\r\nexport default function FarmerDashboard() {\r\n  const { t } = useLanguage();\r\n  const router = useRouter();\r\n  const { user, loading } = useAuth(); // <- get user from context\r\n\r\n  const [inputType, setInputType] = useState(\"\");\r\n  const [packageSize, setPackageSize] = useState(\"\");\r\n  const [repaymentDate, setRepaymentDate] = useState(\"\");\r\n  const [amount, setAmount] = useState(\"\");\r\n  const [loadingRequest, setLoadingRequest] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const [requests, setRequests] = useState([]);\r\n  const [repayments, setRepayments] = useState([]);\r\n\r\n  // Redirect to login if not logged in\r\n  useEffect(() => {\r\n    if (!loading && !user) {\r\n      router.push(\"/auth/login\");\r\n    } else if (user.role !== \"admin\") {\r\n      router.push(\"/auth/login\");\r\n    } else {\r\n      fetchData();\r\n    }\r\n  }, [user, loading, router]);\r\n\r\n  async function fetchData() {\r\n    try {\r\n      const res = await apiGet(\"/loanRequest/myRequests\");\r\n      setRequests(res.requests || []);\r\n      setRepayments(res.repayments || []);\r\n    } catch (err) {\r\n      console.error(err);\r\n      setError(\"Failed to fetch data\");\r\n    }\r\n  }\r\n\r\n  // Submit new loan request\r\n  async function handleSubmit(e) {\r\n    e.preventDefault();\r\n    setError(\"\");\r\n\r\n    if (!inputType || !packageSize || !repaymentDate) {\r\n      setError(t.required);\r\n      return;\r\n    }\r\n\r\n    setLoadingRequest(true);\r\n    try {\r\n      const res = await apiPost(\"/loanRequest\", {\r\n        input_type: inputType,\r\n        package_size: packageSize,\r\n        repayment_date: repaymentDate,\r\n        amount,\r\n      });\r\n\r\n      setRequests([res.request, ...requests]);\r\n      setInputType(\"\");\r\n      setPackageSize(\"\");\r\n      setRepaymentDate(\"\");\r\n      setAmount(\"\");\r\n    } catch (err) {\r\n      setError(err.message || \"Failed to submit request\");\r\n    } finally {\r\n      setLoadingRequest(false);\r\n    }\r\n  }\r\n\r\n  const statusColor = (status) => {\r\n    switch (status) {\r\n      case \"Pending\":\r\n        return \"bg-yellow-200 text-yellow-800\";\r\n      case \"Approved\":\r\n        return \"bg-green-200 text-green-800\";\r\n      case \"Rejected\":\r\n        return \"bg-red-200 text-red-800\";\r\n      default:\r\n        return \"bg-gray-200 text-gray-800\";\r\n    }\r\n  };\r\n\r\n  if (loading || !user) {\r\n    return <div className=\"text-center mt-10\">{t.loading || \"Loading...\"}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      <main className=\"max-w-6xl mx-auto p-4\">\r\n        <h1 className=\"text-2xl font-bold mb-6\">{t.farmerDashboard}</h1>\r\n\r\n        {/* Request Form */}\r\n        <section className=\"mb-8 p-4 bg-white rounded shadow\">\r\n          <h2 className=\"font-semibold mb-4\">{t.submitRequest}</h2>\r\n          {error && <div className=\"mb-3 text-red-600\">{error}</div>}\r\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n            <label className=\"block\">\r\n              <span>{t.inputType}</span>\r\n              <input\r\n                value={inputType}\r\n                onChange={(e) => setInputType(e.target.value)}\r\n                className=\"w-full border p-2 rounded mt-1\"\r\n              />\r\n            </label>\r\n            <label className=\"block\">\r\n              <span>{t.packageSize}</span>\r\n              <input\r\n                value={packageSize}\r\n                onChange={(e) => setPackageSize(e.target.value)}\r\n                className=\"w-full border p-2 rounded mt-1\"\r\n              />\r\n            </label>\r\n            <label className=\"block\">\r\n              <span>{t.repaymentDate}</span>\r\n              <input\r\n                type=\"date\"\r\n                value={repaymentDate}\r\n                onChange={(e) => setRepaymentDate(e.target.value)}\r\n                className=\"w-full border p-2 rounded mt-1\"\r\n              />\r\n            </label>\r\n            <label className=\"block\">\r\n              <span>{t.amountOptional}</span>\r\n              <input\r\n                type=\"number\"\r\n                value={amount}\r\n                onChange={(e) => setAmount(e.target.value)}\r\n                className=\"w-full border p-2 rounded mt-1\"\r\n              />\r\n            </label>\r\n            <button\r\n              type=\"submit\"\r\n              disabled={loadingRequest}\r\n              className=\"w-full bg-green-600 text-white p-2 rounded\"\r\n            >\r\n              {loadingRequest ? \"...\" : t.submit}\r\n            </button>\r\n          </form>\r\n        </section>\r\n\r\n        {/* Requests Table */}\r\n        <section className=\"mb-8\">\r\n          <h2 className=\"font-semibold mb-2\">{t.myRequests}</h2>\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"min-w-full bg-white rounded shadow\">\r\n              <thead>\r\n                <tr>\r\n                  <th className=\"px-4 py-2\">{t.inputType}</th>\r\n                  <th className=\"px-4 py-2\">{t.packageSize}</th>\r\n                  <th className=\"px-4 py-2\">{t.repaymentDate}</th>\r\n                  <th className=\"px-4 py-2\">{t.amount}</th>\r\n                  <th className=\"px-4 py-2\">{t.status}</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {requests.length ? (\r\n                  requests.map((r) => (\r\n                    <tr key={r._id} className=\"text-center border-t\">\r\n                      <td className=\"px-4 py-2\">{r.input_type}</td>\r\n                      <td className=\"px-4 py-2\">{r.package_size}</td>\r\n                      <td className=\"px-4 py-2\">\r\n                        {new Date(r.repayment_date).toLocaleDateString()}\r\n                      </td>\r\n                      <td className=\"px-4 py-2\">{r.amount}</td>\r\n                      <td\r\n                        className={`px-4 py-2 rounded ${statusColor(r.status)}`}\r\n                      >\r\n                        {r.status}\r\n                      </td>\r\n                    </tr>\r\n                  ))\r\n                ) : (\r\n                  <tr>\r\n                    <td colSpan={5} className=\"text-center py-4 text-gray-500\">\r\n                      {t.noRequests}\r\n                    </td>\r\n                  </tr>\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </section>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA,6SAAiD,wBAAwB;AALzE;;;;;;;AAOe,SAAS;IACtB,MAAM,EAAE,CAAC,EAAE,GAAG,IAAA,6LAAW;IACzB,MAAM,SAAS,IAAA,mMAAS;IACxB,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,IAAA,qLAAO,KAAI,2BAA2B;IAEhE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,qQAAQ,EAAC;IAC3C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,qQAAQ,EAAC;IAC/C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,qQAAQ,EAAC;IACnD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,qQAAQ,EAAC;IACrC,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,qQAAQ,EAAC;IACrD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,qQAAQ,EAAC;IAEnC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,qQAAQ,EAAC,EAAE;IAC3C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,qQAAQ,EAAC,EAAE;IAE/C,qCAAqC;IACrC,IAAA,sQAAS,EAAC;QACR,IAAI,CAAC,WAAW,CAAC,MAAM;YACrB,OAAO,IAAI,CAAC;QACd,OAAO,IAAI,KAAK,IAAI,KAAK,SAAS;YAChC,OAAO,IAAI,CAAC;QACd,OAAO;YACL;QACF;IACF,GAAG;QAAC;QAAM;QAAS;KAAO;IAE1B,eAAe;QACb,IAAI;YACF,MAAM,MAAM,MAAM,IAAA,0KAAM,EAAC;YACzB,YAAY,IAAI,QAAQ,IAAI,EAAE;YAC9B,cAAc,IAAI,UAAU,IAAI,EAAE;QACpC,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC;YACd,SAAS;QACX;IACF;IAEA,0BAA0B;IAC1B,eAAe,aAAa,CAAC;QAC3B,EAAE,cAAc;QAChB,SAAS;QAET,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC,eAAe;YAChD,SAAS,EAAE,QAAQ;YACnB;QACF;QAEA,kBAAkB;QAClB,IAAI;YACF,MAAM,MAAM,MAAM,IAAA,2KAAO,EAAC,gBAAgB;gBACxC,YAAY;gBACZ,cAAc;gBACd,gBAAgB;gBAChB;YACF;YAEA,YAAY;gBAAC,IAAI,OAAO;mBAAK;aAAS;YACtC,aAAa;YACb,eAAe;YACf,iBAAiB;YACjB,UAAU;QACZ,EAAE,OAAO,KAAK;YACZ,SAAS,IAAI,OAAO,IAAI;QAC1B,SAAU;YACR,kBAAkB;QACpB;IACF;IAEA,MAAM,cAAc,CAAC;QACnB,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF;IAEA,IAAI,WAAW,CAAC,MAAM;QACpB,qBAAO,kSAAC;YAAI,WAAU;sBAAqB,EAAE,OAAO,IAAI;;;;;;IAC1D;IAEA,qBACE,kSAAC;QAAI,WAAU;kBACb,cAAA,kSAAC;YAAK,WAAU;;8BACd,kSAAC;oBAAG,WAAU;8BAA2B,EAAE,eAAe;;;;;;8BAG1D,kSAAC;oBAAQ,WAAU;;sCACjB,kSAAC;4BAAG,WAAU;sCAAsB,EAAE,aAAa;;;;;;wBAClD,uBAAS,kSAAC;4BAAI,WAAU;sCAAqB;;;;;;sCAC9C,kSAAC;4BAAK,UAAU;4BAAc,WAAU;;8CACtC,kSAAC;oCAAM,WAAU;;sDACf,kSAAC;sDAAM,EAAE,SAAS;;;;;;sDAClB,kSAAC;4CACC,OAAO;4CACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;4CAC5C,WAAU;;;;;;;;;;;;8CAGd,kSAAC;oCAAM,WAAU;;sDACf,kSAAC;sDAAM,EAAE,WAAW;;;;;;sDACpB,kSAAC;4CACC,OAAO;4CACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;4CAC9C,WAAU;;;;;;;;;;;;8CAGd,kSAAC;oCAAM,WAAU;;sDACf,kSAAC;sDAAM,EAAE,aAAa;;;;;;sDACtB,kSAAC;4CACC,MAAK;4CACL,OAAO;4CACP,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,KAAK;4CAChD,WAAU;;;;;;;;;;;;8CAGd,kSAAC;oCAAM,WAAU;;sDACf,kSAAC;sDAAM,EAAE,cAAc;;;;;;sDACvB,kSAAC;4CACC,MAAK;4CACL,OAAO;4CACP,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;4CACzC,WAAU;;;;;;;;;;;;8CAGd,kSAAC;oCACC,MAAK;oCACL,UAAU;oCACV,WAAU;8CAET,iBAAiB,QAAQ,EAAE,MAAM;;;;;;;;;;;;;;;;;;8BAMxC,kSAAC;oBAAQ,WAAU;;sCACjB,kSAAC;4BAAG,WAAU;sCAAsB,EAAE,UAAU;;;;;;sCAChD,kSAAC;4BAAI,WAAU;sCACb,cAAA,kSAAC;gCAAM,WAAU;;kDACf,kSAAC;kDACC,cAAA,kSAAC;;8DACC,kSAAC;oDAAG,WAAU;8DAAa,EAAE,SAAS;;;;;;8DACtC,kSAAC;oDAAG,WAAU;8DAAa,EAAE,WAAW;;;;;;8DACxC,kSAAC;oDAAG,WAAU;8DAAa,EAAE,aAAa;;;;;;8DAC1C,kSAAC;oDAAG,WAAU;8DAAa,EAAE,MAAM;;;;;;8DACnC,kSAAC;oDAAG,WAAU;8DAAa,EAAE,MAAM;;;;;;;;;;;;;;;;;kDAGvC,kSAAC;kDACE,SAAS,MAAM,GACd,SAAS,GAAG,CAAC,CAAC,kBACZ,kSAAC;gDAAe,WAAU;;kEACxB,kSAAC;wDAAG,WAAU;kEAAa,EAAE,UAAU;;;;;;kEACvC,kSAAC;wDAAG,WAAU;kEAAa,EAAE,YAAY;;;;;;kEACzC,kSAAC;wDAAG,WAAU;kEACX,IAAI,KAAK,EAAE,cAAc,EAAE,kBAAkB;;;;;;kEAEhD,kSAAC;wDAAG,WAAU;kEAAa,EAAE,MAAM;;;;;;kEACnC,kSAAC;wDACC,WAAW,CAAC,kBAAkB,EAAE,YAAY,EAAE,MAAM,GAAG;kEAEtD,EAAE,MAAM;;;;;;;+CAVJ,EAAE,GAAG;;;;sEAehB,kSAAC;sDACC,cAAA,kSAAC;gDAAG,SAAS;gDAAG,WAAU;0DACvB,EAAE,UAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAWnC","debugId":null}}]
}