{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jean%20Bosco/Desktop/FullStack/Verdln/verdln_frotend/Utils/api.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:5000/api\";\r\n\r\n// Helper to get token\r\nfunction getToken() {\r\n  if (typeof window !== \"undefined\") {\r\n    return localStorage.getItem(\"authToken\");\r\n  }\r\n  return null;\r\n}\r\n\r\n// GET request\r\nexport async function apiGet(endpoint) {\r\n  try {\r\n    const token = getToken();\r\n    const res = await axios.get(`${API_URL}${endpoint}`, {\r\n      headers: token ? { Authorization: `Bearer ${token}` } : {},\r\n    });\r\n    return res.data;\r\n  } catch (err) {\r\n    throw err.response?.data || err;\r\n  }\r\n}\r\n\r\n// POST request\r\nexport async function apiPost(endpoint, payload) {\r\n  try {\r\n    const token = getToken();\r\n    const res = await axios.post(`${API_URL}${endpoint}`, payload, {\r\n      headers: token ? { Authorization: `Bearer ${token}` } : {},\r\n    });\r\n    return res.data;\r\n  } catch (err) {\r\n    throw err.response?.data || err;\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAEgB;AAFhB;;AAEA,MAAM,UAAU,+NAAO,CAAC,GAAG,CAAC,mBAAmB,IAAI;AAEnD,sBAAsB;AACtB,SAAS;IACP,wCAAmC;QACjC,OAAO,aAAa,OAAO,CAAC;IAC9B;;;AAEF;AAGO,eAAe,OAAO,QAAQ;IACnC,IAAI;QACF,MAAM,QAAQ;QACd,MAAM,MAAM,MAAM,uMAAK,CAAC,GAAG,CAAC,AAAC,GAAY,OAAV,SAAmB,OAAT,WAAY;YACnD,SAAS,QAAQ;gBAAE,eAAe,AAAC,UAAe,OAAN;YAAQ,IAAI,CAAC;QAC3D;QACA,OAAO,IAAI,IAAI;IACjB,EAAE,OAAO,KAAK;YACN;QAAN,MAAM,EAAA,gBAAA,IAAI,QAAQ,cAAZ,oCAAA,cAAc,IAAI,KAAI;IAC9B;AACF;AAGO,eAAe,QAAQ,QAAQ,EAAE,OAAO;IAC7C,IAAI;QACF,MAAM,QAAQ;QACd,MAAM,MAAM,MAAM,uMAAK,CAAC,IAAI,CAAC,AAAC,GAAY,OAAV,SAAmB,OAAT,WAAY,SAAS;YAC7D,SAAS,QAAQ;gBAAE,eAAe,AAAC,UAAe,OAAN;YAAQ,IAAI,CAAC;QAC3D;QACA,OAAO,IAAI,IAAI;IACjB,EAAE,OAAO,KAAK;YACN;QAAN,MAAM,EAAA,gBAAA,IAAI,QAAQ,cAAZ,oCAAA,cAAc,IAAI,KAAI;IAC9B;AACF","debugId":null}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jean%20Bosco/Desktop/FullStack/Verdln/verdln_frotend/app/farmer/dashboard/page.jsx"],"sourcesContent":["\"use client\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useLanguage } from \"@/Context/LanguageContext\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { apiGet, apiPost } from \"@/Utils/api\";\r\nimport { useAuth } from \"@/Context/AuthContext\";\r\n\r\nexport default function FarmerDashboard() {\r\n  const { t, lang } = useLanguage(); // get language\r\n  const router = useRouter();\r\n  const { user, loading } = useAuth();\r\n\r\n  const [inputType, setInputType] = useState(\"\");\r\n  const [packageSize, setPackageSize] = useState(\"\");\r\n  const [repaymentDate, setRepaymentDate] = useState(\"\");\r\n  const [amount, setAmount] = useState(\"\");\r\n  const [loadingRequest, setLoadingRequest] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const [requests, setRequests] = useState([]);\r\n\r\n  const inputOptions = [\r\n    { value: \"seeds\", label: { en: \"Seeds\", rw: \"Imbuto\" } },\r\n    { value: \"fertilizer\", label: { en: \"Fertilizer\", rw: \"Ifumbire\" } },\r\n    {\r\n      value: \"pesticides\",\r\n      label: { en: \"Pesticides\", rw: \"Imiti yica udukoko\" },\r\n    },\r\n  ];\r\n\r\n  const statusLabels = {\r\n    Pending: { en: \"Pending\", rw: \"Bitegereje\" },\r\n    Approved: { en: \"Approved\", rw: \"Yemejwe\" },\r\n    Rejected: { en: \"Rejected\", rw: \"Yanenzwe\" },\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!loading && !user) {\r\n      router.push(\"/auth/login\");\r\n    } else {\r\n      fetchData();\r\n    }\r\n  }, [user, loading, router]);\r\n\r\n  async function fetchData() {\r\n    try {\r\n      const res = await apiGet(`/loans/farmer/${user?.id || user?._id}`);\r\n      setRequests(res.requests || []);\r\n    } catch (err) {\r\n      console.error(err);\r\n      // setError(\"Failed to fetch data\");\r\n    }\r\n  }\r\n\r\n  async function handleSubmit(e) {\r\n    e.preventDefault();\r\n    setError(\"\");\r\n\r\n    if (!inputType || !packageSize || !repaymentDate) {\r\n      setError(t.required);\r\n      fetchData();\r\n      return;\r\n    }\r\n\r\n    setLoadingRequest(true);\r\n    try {\r\n      const res = await apiPost(\"/loans/submit\", {\r\n        farmerId: user?.id || user?._id,\r\n        input_type: inputType,\r\n        package_size: packageSize,\r\n        repayment_date: repaymentDate,\r\n        amount,\r\n      });\r\n\r\n      // setRequests([res.request, ...requests]);\r\n      setInputType(\"\");\r\n      setPackageSize(\"\");\r\n      setRepaymentDate(\"\");\r\n      setAmount(\"\");\r\n    } catch (err) {\r\n      setError(err.message || \"Failed to submit request\");\r\n    } finally {\r\n      setLoadingRequest(false);\r\n    }\r\n  }\r\n\r\n  const statusColor = (status) => {\r\n    switch (status) {\r\n      case \"Pending\":\r\n        return \"bg-yellow-200 text-yellow-800\";\r\n      case \"Approved\":\r\n        return \"bg-green-200 text-green-800\";\r\n      case \"Rejected\":\r\n        return \"bg-red-200 text-red-800\";\r\n      default:\r\n        return \"bg-gray-200 text-gray-800\";\r\n    }\r\n  };\r\n\r\n  if (loading || !user) {\r\n    return <div className=\"text-center mt-10\">{t.loading || \"Loading...\"}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      <main className=\"max-w-6xl mx-auto p-4\">\r\n        <h1 className=\"text-2xl font-bold mb-6\">{t.farmerDashboard}</h1>\r\n\r\n        {/* Request Form */}\r\n        <section className=\"mb-8 p-4 bg-white rounded shadow\">\r\n          <h2 className=\"font-semibold mb-4\">{t.submitRequest}</h2>\r\n          {error && <div className=\"mb-3 text-red-600\">{error}</div>}\r\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n            <label className=\"block\">\r\n              <span>{t.inputType}</span>\r\n              <select\r\n                value={inputType}\r\n                onChange={(e) => setInputType(e.target.value)}\r\n                className=\"w-full border p-2 rounded mt-1\"\r\n              >\r\n                <option value=\"\">{t.choice}</option>\r\n                {inputOptions.map((opt) => (\r\n                  <option key={opt.value} value={opt.value}>\r\n                    {opt.label[lang]}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </label>\r\n\r\n            <label className=\"block\">\r\n              <span>{t.packageSize}</span>\r\n              <input\r\n                value={packageSize}\r\n                onChange={(e) => setPackageSize(e.target.value)}\r\n                className=\"w-full border p-2 rounded mt-1\"\r\n              />\r\n            </label>\r\n\r\n            <label className=\"block\">\r\n              <span>{t.repaymentDate}</span>\r\n              <input\r\n                type=\"date\"\r\n                value={repaymentDate}\r\n                onChange={(e) => setRepaymentDate(e.target.value)}\r\n                className=\"w-full border p-2 rounded mt-1\"\r\n              />\r\n            </label>\r\n\r\n            <label className=\"block\">\r\n              <span>{t.amountOptional}</span>\r\n              <input\r\n                type=\"number\"\r\n                value={amount}\r\n                onChange={(e) => setAmount(e.target.value)}\r\n                className=\"w-full border p-2 rounded mt-1\"\r\n              />\r\n            </label>\r\n\r\n            <button\r\n              type=\"submit\"\r\n              disabled={loadingRequest}\r\n              className=\"w-full bg-green-600 text-white p-2 rounded\"\r\n            >\r\n              {loadingRequest ? \"...\" : t.submit}\r\n            </button>\r\n          </form>\r\n        </section>\r\n\r\n        {/* Requests Table */}\r\n        <section className=\"mb-8\">\r\n          <h2 className=\"font-semibold mb-2\">{t.myRequests}</h2>\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"min-w-full bg-white rounded shadow\">\r\n              <thead>\r\n                <tr>\r\n                  <th className=\"px-4 py-2\">{t.inputType}</th>\r\n                  <th className=\"px-4 py-2\">{t.packageSize}</th>\r\n                  <th className=\"px-4 py-2\">{t.repaymentDate}</th>\r\n                  <th className=\"px-4 py-2\">{t.amount}</th>\r\n                  <th className=\"px-4 py-2\">{t.status}</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {requests.length ? (\r\n                  requests.map((r) => (\r\n                    <tr key={r._id} className=\"text-center border-t\">\r\n                      <td className=\"px-4 py-2\">\r\n                        {inputOptions.find((i) => i.value === r.input_type)\r\n                          ?.label[lang] || r.input_type}\r\n                      </td>\r\n                      <td className=\"px-4 py-2\">{r.package_size}</td>\r\n                      <td className=\"px-4 py-2\">\r\n                        {new Date(r.repayment_date).toLocaleDateString()}\r\n                      </td>\r\n                      <td className=\"px-4 py-2\">{r.amount}</td>\r\n                      <td\r\n                        className={`px-4 py-2 rounded ${statusColor(r.status)}`}\r\n                      >\r\n                        {statusLabels[\r\n                          r.status?.trim()?.charAt(0).toUpperCase() +\r\n                            r.status?.trim()?.slice(1)\r\n                        ]?.[lang] || r.status}\r\n                      </td>\r\n                    </tr>\r\n                  ))\r\n                ) : (\r\n                  <tr>\r\n                    <td colSpan={5} className=\"text-center py-4 text-gray-500\">\r\n                      {t.noRequests}\r\n                    </td>\r\n                  </tr>\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </section>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}